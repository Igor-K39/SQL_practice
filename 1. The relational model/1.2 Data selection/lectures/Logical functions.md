## Выборка данных, вычисляемые столбцы, логические функции
В SQL реализована возможность заносить в поле значение в зависимости от условия. Для этого используется функция IF: 
```sql
поле = IF(логическое_выражение, выражение_1, выражение_2)
```
Функция вычисляет логическое_выражение, если оно истина – в поле заносится значение выражения_1, в противном случае –  значение выражения_2. Все три параметра IF() являются обязательными. Допускается использование вложенных функций, вместо выражения_1 или выражения_2 может стоять новая функция IF  

**Пример.** Для каждой книги из таблицы book установим скидку следующим образом: если количество книг меньше 4, то скидка будет составлять 50% от цены, в противном случае 30%. Округлить скидку до двух знаков после запятой.
```sql
SELECT title, amount, price, ROUND( IF(amount < 4, price * 0.5, price * 0.7), 2) AS sale
  FROM book;
```
```
Результат:
+-----------------------+--------+--------+--------+
| title                 | amount | price  | sale   |
+-----------------------+--------+--------+--------+
| Мастер и Маргарита    | 3      | 670.99 | 335.50 |
| Белая гвардия         | 5      | 540.50 | 378.35 |
| Идиот                 | 10     | 460.00 | 322.00 |
| Братья Карамазовы     | 2      | 799.01 | 399.51 |
| Стихотворения и поэмы | 15     | 650.00 | 455.00 |
+-----------------------+--------+--------+--------+
```

**Пример 2.** Усложним вычисление скидки в зависимости от количества книг. Если количество книг меньше 4 – то скидка 50%, меньше 11 – 30%, в остальных случаях – 10%. И еще укажем какая именно скидка на каждую книгу.
```sql
SELECT title, amount, price, 
       ROUND( IF(amount < 4, price * 0.5, IF(amount < 11, price * 0.7, price * 0.9)), 2) AS sale,
              IF(amount < 4, 'скидка 50%', IF(amount < 11, 'скидка 30%', 'скидка 10%'))  AS Ваша_скидка
FROM book;
```

## Выборка данных по условию
С помощью запросов можно включать в итоговую выборку не все строки исходной таблицы, а только те, которые отвечают некоторому условию. Для этого после указания таблицы, откуда выбираются данные, задается ключевое слово WHERE и логическое выражение, от результата которого зависит будет ли включена строка в выборку или нет. Если условие – истина, то строка(запись)  включается в выборку, если ложь – нет.

Логическое выражение может включать операторы сравнения (равно «=», не равно «<>», больше «>», меньше «<», больше или равно«>=», меньше или равно «<=») и выражения, допустимые в SQL.

**Пример 3.** Вывести название, автора  и стоимость (цена умножить на количество) тех книг, стоимость которых больше 4000 рублей
```sql
SELECT title, author, price * amount AS total
  FROM book
 WHERE price * amount > 4000;
```
```
Результат:
+-----------------------+------------------+---------+
| title                 | author           | total   |
+-----------------------+------------------+---------+
| Идиот                 | Достоевский Ф.М. | 4600.00 |
| Стихотворения и поэмы | Есенин С.А.      | 9750.00 |
+-----------------------+------------------+---------+
```

## Выборка данных, логические операции
Логическое выражение после ключевого слова WHERE кроме операторов сравнения  и выражений может включать  логические операции (И «and», ИЛИ «or», НЕ «not») и круглые скобки, изменяющие приоритеты выполнения операций.  

Приоритеты операций:
- круглые скобки  
- умножение (*), деление (/)  
- сложение (+), вычитание (-)  
- операторы сравнения (=, >, <, >=, <=, <>)  
- NOT  
- AND  
- OR  

**Пример 4.** Вывести название, цену  тех книг, которые написал Булгаков или Есенин, ценой больше 600 рублей
```sql
SELECT title, author, price 
  FROM book
 WHERE (author = 'Булгаков М.А.' OR author = 'Есенин С.А.') AND price > 600;
```
```
Результат:
+-----------------------+---------------+--------+
| title                 | author        | price  |
+-----------------------+---------------+--------+
| Мастер и Маргарита    | Булгаков М.А. | 670.99 |
| Стихотворения и поэмы | Есенин С.А.   | 650.00 |
+-----------------------+---------------+--------+
```
