### Задание 1.

Вывести все заказы Баранова Павла (id заказа, какие книги, по какой цене и в каком количестве он заказал) в отсортированном по номеру заказа и названиям книг виде.

Результат:
```
Query result:
+--------+--------------------+--------+--------+
| buy_id | title              | price  | amount |
+--------+--------------------+--------+--------+
| 1      | Идиот              | 460.00 | 1      |
| 1      | Мастер и Маргарита | 670.99 | 1      |
| 1      | Черный человек     | 570.20 | 2      |
| 4      | Игрок              | 480.50 | 1      |
+--------+--------------------+--------+--------+
Affected rows: 4
```

### Задание 2. 

Посчитать, сколько раз была заказана каждая книга, для книги вывести ее автора (нужно посчитать, в каком количестве заказов фигурирует каждая книга).  Вывести фамилию и инициалы автора, название книги, последний столбец назвать Количество. Результат отсортировать сначала  по фамилиям авторов, а потом по названиям книг.

Фрагмент логической схемы базы данных:  

![ ](https://ucarecdn.com/c9356f96-1b19-42ce-8c9e-e7a8169734fc/)

Результат:
```
+------------------+-----------------------+------------+
| name_author      | title                 | Количество |
+------------------+-----------------------+------------+
| Булгаков М.А.    | Белая гвардия         | 1          |
| Булгаков М.А.    | Мастер и Маргарита    | 2          |
| Достоевский Ф.М. | Братья Карамазовы     | 0          |
| Достоевский Ф.М. | Игрок                 | 1          |
| Достоевский Ф.М. | Идиот                 | 2          |
| Есенин С.А.      | Стихотворения и поэмы | 0          |
| Есенин С.А.      | Черный человек        | 1          |
| Пастернак Б.Л.   | Лирика                | 1          |
+------------------+-----------------------+------------+
```

### Задание 3. 

Вывести города, в которых живут клиенты, оформлявшие заказы в интернет-магазине. Указать количество заказов в каждый город, этот столбец назвать Количество. Информацию вывести по убыванию количества заказов, а затем в алфавитном порядке по названию городов.

Фрагмент логической схемы базы данных:

![](https://ucarecdn.com/1e4836b9-6cf8-41bd-9f82-38b11c7882aa/)

Результат:
```
+-----------------+------------+
| name_city       | Количество |
+-----------------+------------+
| Владивосток     | 2          |
| Москва          | 1          |
| Санкт-Петербург | 1          |
+-----------------+------------+
```

### Задание 4.

Вывести номера всех оплаченных заказов и даты, когда они были оплачены.

Фрагмент логической схемы базы данных:

![](https://ucarecdn.com/a6be5406-fcef-4a74-89bc-eb7833621092/)

Результат:
```
+--------+---------------+
| buy_id | date_step_end |
+--------+---------------+
| 1      | 2020-02-20    |
| 2      | 2020-02-28    |
| 3      | 2020-03-05    |
+--------+---------------+
```

### Задание 5.

Вывести информацию о каждом заказе: его номер, кто его сформировал (фамилия пользователя) и его стоимость (сумма произведений количества заказанных книг и их цены), в отсортированном по номеру заказа виде. Последний столбец назвать Стоимость.

Фрагмент логической схемы базы данных:

![](https://ucarecdn.com/cce071e8-3a35-4642-8fff-460f0899e4eb/)

Результат:
```
+--------+----------------+-----------+
| buy_id | name_client    | Стоимость |
+--------+----------------+-----------+
| 1      | Баранов Павел  | 2271.39   |
| 2      | Семенонов Иван | 1037.98   |
| 3      | Абрамова Катя  | 2131.49   |
| 4      | Баранов Павел  | 480.50    |
+--------+----------------+-----------+
```

### Задание 6. 

Вывести номера заказов (buy_id) и названия этапов, на которых они в данный момент находятся. Если заказ доставлен –  информацию о нем не выводить. Информацию отсортировать по возрастанию buy_id.

Фрагмент логической схемы базы данных:

![](https://ucarecdn.com/0178ea29-ab37-4ce9-83ac-bd49d2636c20/)

Результат:
```
+--------+-----------------+
| buy_id | name_step       |
+--------+-----------------+
| 2      | Транспортировка |
| 3      | Доставка        |
| 4      | Оплата          |
+--------+-----------------+
```

### Задание 7.

В таблице city для каждого города указано количество дней, за которые заказ может быть доставлен в этот город (рассматривается только этап Транспортировка). Для тех заказов, которые прошли этап транспортировки, вывести количество дней за которое заказ реально доставлен в город. А также, если заказ доставлен с опозданием, указать количество дней задержки, в противном случае вывести 0. В результат включить номер заказа (buy_id), а также вычисляемые столбцы Количество_дней и Опоздание. Информацию вывести в отсортированном по номеру заказа виде.

Фрагмент логической схемы базы данных:

![](https://ucarecdn.com/6b3c2d87-7353-48e6-adfd-26c338886f4a/)

### Задание 8.

Выбрать всех клиентов, которые заказывали книги Достоевского, информацию вывести в отсортированном по алфавиту виде.

Фрагмент логической схемы:

![](https://ucarecdn.com/81b4c54e-bfb0-4582-9df9-279b6be0154e/)

### Задание 9.

Вывести жанр (или жанры), в котором было заказано больше всего экземпляров книг, указать это количество. Последний столбец назвать Количество.

Фрагмент логической схемы:

![](https://ucarecdn.com/710494ce-e3a3-4d4b-8f10-5ab41b474b31/)

### Задание 10.

Сравнить ежемесячную выручку от продажи книг за текущий и предыдущий годы. Для этого вывести год, месяц, сумму выручки в отсортированном сначала по возрастанию месяцев, затем по возрастанию лет виде. Название столбцов: Год, Месяц, Сумма.

Фрагмент логической схемы:

![](https://ucarecdn.com/843369b4-8065-4023-99bf-60a08aaafa34/)

Информация о продажах предыдущего года хранится в архивной таблице buy_archive, которая создается в конце года на основе информации из таблиц базы данных и имеет следующую структуру:
```
buy_archive_id ключевой столбец
buy_id         id заказов, выбирается из таблицы buy
client_id      id клиентов, выбирается из из таблицы client
book_id        id книги, выбирается из таблицы book
date_payment   дата оплаты заказа, выбирается из столбца date_step_end
               таблицы buy_step этапа «Оплата» соответствующего заказа
price          цена книги в текущем заказе из таблицы book
               (хранится, так как цена может измениться )
amount         количество купленных книг в текущем заказе, из таблицы buy_book
```

### Задание 11.
Для каждой отдельной книги необходимо вывести информацию о количестве проданных экземпляров и их стоимости за текущий и предыдущий год . Вычисляемые столбцы назвать Количество и Сумма. Информацию отсортировать по убыванию стоимости.

Фрагмент логической схемы:

![](https://ucarecdn.com/d5c5d16e-32eb-4caa-8fc8-6982cda2ac32/)

Информация о продажах прошлого года хранится в таблице buy_archive следующей структуры:

![](https://ucarecdn.com/bd089cc7-acb0-442e-a276-4995f7ade4b1/)

Результат:
```
+-----------------------+------------+---------+
| title                 | Количество | Сумма   |
+-----------------------+------------+---------+
| Братья Карамазовы     | 8          | 6247.20 |
| Мастер и Маргарита    | 6          | 4024.38 |
| Идиот                 | 5          | 2281.80 |
| Белая гвардия         | 3          | 1581.10 |
| Черный человек        | 2          | 1140.40 |
| Лирика                | 2          | 1037.98 |
| Игрок                 | 2          | 961.80  |
| Стихотворения и поэмы | 1          | 650.00  |
+-----------------------+------------+---------+
```